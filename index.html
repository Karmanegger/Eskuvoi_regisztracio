<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Esküvői Regisztráció</title>
<style>
/* Alap stílusok */
body {
    margin:0;
    font-family: 'Arial', sans-serif;
    background: linear-gradient(135deg, #000000 30%, #c0c0c0 70%, #f7c2c2 100%);
    color: #fff;
}
.container {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
}
header { text-align:center; margin-bottom:20px; }
h1 { font-family: 'Georgia', serif; font-size:2.5em; color:#f7c2c2; }

/* Tab stílus */
.tabs { display:flex; justify-content:center; margin-bottom:20px; flex-wrap:wrap; }
.tab { padding:10px 20px; margin:5px; background:#222; color:#f7c2c2; border-radius:6px; cursor:pointer; font-weight:bold; }
.tab.active { background:#c0c0c0; color:#000; }

.tab-content { display:none; background: rgba(0,0,0,0.7); padding:20px; border-radius:12px; }
.tab-content.active { display:block; }

/* Form */
form { display:flex; flex-direction:column; gap:15px; }
input[type="text"], input[type="number"], textarea { padding:10px; border-radius:6px; border:none; font-size:1em; }
textarea { resize:vertical; }
label { font-weight:bold; color:#f7c2c2; }
button { padding:12px; border:none; border-radius:6px; background:#c0c0c0; color:#000; font-weight:bold; cursor:pointer; transition:0.3s; }
button:hover { background:#f7c2c2; }

/* Táblázat */
table { width:100%; border-collapse:collapse; color:#000; background:rgba(255,255,255,0.85); border-radius:8px; overflow:hidden; margin-top:15px; }
th, td { border:1px solid #c0c0c0; padding:10px; text-align:left; }
th { background:#222; color:#f7c2c2; }

/* Delete & search */
.delete-section input, #search { margin-bottom:10px; padding:8px; width:100%; border-radius:6px; border:none; }

/* Mobilbarát */
@media (max-width:600px){
    .tabs { flex-direction:column; align-items:center; }
    th, td { font-size:0.9em; }
}
</style>
</head>
<body>
<div class="container">
    <header>
        <h1>Esküvői Regisztráció</h1>
    </header>

    <div class="tabs">
        <div class="tab active" data-tab="registration">Regisztráció</div>
        <div class="tab" data-tab="participants">Résztvevők</div>
    </div>

    <div class="tab-content active" id="registration">
        <form id="guestForm">
            <label>Név:</label>
            <input type="text" id="name" required placeholder="Például: Kovács Anna">

            <label>Hányan érkeznek:</label>
            <input type="number" id="people" required min="1" value="1">

            <label>Szeretne ott aludni? Ha igen, hányan:</label>
            <input type="number" id="sleep" min="0" value="0">

            <label>Ételérzékenység:</label>
            <input type="text" id="food" placeholder="pl. glutén, laktóz">

            <label>Speciális igények:</label>
            <textarea id="special" rows="2" placeholder="pl. vegetáriánus, szobatárs, transzport"></textarea>

            <button type="submit">Mentés</button>
        </form>
    </div>

    <div class="tab-content" id="participants">
        <div class="delete-section">
            <label>Jelszó az adatok törléséhez:</label>
            <input type="password" id="deletePass" placeholder="Írd be a csigakaki jelszót">
            <button id="deleteBtn">Összes adat törlése</button>
        </div>

        <input type="text" id="search" placeholder="Keresés név vagy kategória szerint">

        <table id="participantsTable">
            <thead>
                <tr>
                    <th>Név</th>
                    <th>Hányan jönnek</th>
                    <th>Alvás</th>
                    <th>Ételérzékenység</th>
                    <th>Speciális igények</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>

<script>
// Firebase konfiguráció
const firebaseConfig = {
  apiKey: "AIzaSyC5A5bogaOqW6OKnUEzPxtFMadSiUj-2ZU",
  authDomain: "eskuvoiregisztracio.firebaseapp.com",
  databaseURL: "https://eskuvoiregisztracio-default-rtdb.europe-west1.firebasedatabase.app/",
  projectId: "eskuvoiregisztracio",
  storageBucket: "eskuvoiregisztracio.appspot.com",
  messagingSenderId: "113983296673",
  appId: "1:113983296673:web:b1f9a0c049bc42c6ab8ce0"
};

const app = firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// Tab váltás
const tabs = document.querySelectorAll('.tab');
const tabContents = document.querySelectorAll('.tab-content');
tabs.forEach(tab => {
    tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        const target = tab.dataset.tab;
        tabContents.forEach(tc => {
            tc.classList.remove('active');
            if(tc.id === target) tc.classList.add('active');
        });
    });
});

const form = document.getElementById('guestForm');
const tableBody = document.querySelector('#participantsTable tbody');
const deleteBtn = document.getElementById('deleteBtn');
const deletePass = document.getElementById('deletePass');
const searchInput = document.getElementById('search');
const PASSWORD = 'csigakaki';

// Adatok beküldése Firebase-be
form.addEventListener('submit', e => {
    e.preventDefault();
    const guest = {
        name: document.getElementById('name').value.trim(),
        people: document.getElementById('people').value,
        sleep: document.getElementById('sleep').value,
        food: document.getElementById('food').value.trim(),
        special: document.getElementById('special').value.trim()
    };
    db.ref('participants').push(guest);
    form.reset();
});

// Résztvevők valós idejű listázása
db.ref('participants').on('value', snapshot => {
    tableBody.innerHTML = '';
    snapshot.forEach(childSnap => {
        const p = childSnap.val();
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${p.name}</td>
            <td>${p.people}</td>
            <td>${p.sleep}</td>
            <td>${p.food}</td>
            <td>${p.special}</td>
        `;
        tableBody.appendChild(row);
    });
});

// Keresés
searchInput.addEventListener('input', e => {
    const term = e.target.value.toLowerCase();
    const rows = tableBody.querySelectorAll('tr');
    rows.forEach(row => {
        row.style.display = [...row.cells].some(cell => cell.textContent.toLowerCase().includes(term)) ? '' : 'none';
    });
});

// Adatok törlése jelszóval
deleteBtn.addEventListener('click', () => {
    if(deletePass.value === PASSWORD){
        if(confirm('Biztosan törlöd az összes adatot?')){
            db.ref('participants').remove();
            deletePass.value = '';
        }
    } else alert('Helytelen jelszó!');
});
</script>
</body>
</html>
