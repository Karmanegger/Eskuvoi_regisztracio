<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Esküvői Regisztráció</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #000000, #c0c0c0, #f4c2c2);
    color: #000;
    padding: 20px;
  }
  h1, h2 { text-align: center; }
  form {
    max-width: 500px;
    margin: 20px auto;
    background: rgba(255,255,255,0.9);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  }
  input, select {
    width: 100%;
    margin-bottom: 12px;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #aaa;
    font-size: 1em;
  }
  button {
    width: 100%;
    padding: 12px;
    border: none;
    border-radius: 6px;
    background-color: #bfa9a9;
    color: #000;
    font-weight: bold;
    font-size: 1em;
    cursor: pointer;
  }
  button:hover { background-color: #a88a8a; }
  table {
    width: 100%;
    max-width: 800px;
    margin: 20px auto;
    border-collapse: collapse;
    background: rgba(255,255,255,0.9);
    border-radius: 8px;
    overflow: hidden;
  }
  th, td {
    border: 1px solid #aaa;
    padding: 8px;
    text-align: left;
  }
  th {
    background-color: #bfa9a9;
  }
  .delete-section {
    max-width: 500px;
    margin: 20px auto;
    text-align: center;
  }
  .delete-section input {
    width: 70%;
    display: inline-block;
    padding: 8px;
    border-radius: 6px;
    border: 1px solid #aaa;
  }
  .delete-section button {
    width: 25%;
    display: inline-block;
    padding: 8px;
  }
</style>
</head>
<body>

<h1>Esküvői Regisztráció</h1>

<form id="registrationForm">
  <input type="text" id="name" placeholder="Név" required>
  <input type="number" id="people" placeholder="Hányan jönnek?" required>
  <select id="sleep">
    <option value="Nem">Nem szeretne aludni</option>
    <option value="Igen">Szeretne aludni</option>
  </select>
  <input type="number" id="sleepCount" placeholder="Ha igen, hányan?" value="0">
  <input type="text" id="food" placeholder="Ételérzékenység">
  <input type="text" id="special" placeholder="Speciális igények">
  <button type="submit">Regisztrálok</button>
</form>

<h2>Résztvevők:</h2>
<table id="participantsTable">
  <thead>
    <tr>
      <th>Név</th>
      <th>Hányan jönnek</th>
      <th>Alvás</th>
      <th>Ételérzékenység</th>
      <th>Speciális igények</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="delete-section">
  <h2>Összes adat törlése</h2>
  <input type="password" id="deletePassword" placeholder="Írd be a jelszót">
  <button id="deleteAllBtn">Törlés</button>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js"></script>

<script>
  // Firebase konfiguráció
  const firebaseConfig = {
    apiKey: "AIzaSyC5A5bogaOqW6OKnUEzPxtFMadSiUj-2ZU",
    authDomain: "eskuvoiregisztracio.firebaseapp.com",
    projectId: "eskuvoiregisztracio",
    storageBucket: "eskuvoiregisztracio.firebasestorage.app",
    messagingSenderId: "113983296673",
    appId: "1:113983296673:web:b1f9a0c049bc42c6ab8ce0",
    measurementId: "G-2DJCG5N94C",
    databaseURL: "https://eskuvoiregisztracio-default-rtdb.europe-west1.firebasedatabase.app/"
  };

  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const form = document.getElementById('registrationForm');
  const tableBody = document.querySelector('#participantsTable tbody');
  const deleteBtn = document.getElementById('deleteAllBtn');
  const deletePassword = document.getElementById('deletePassword');
  const PASSWORD = "csigakaki";

  // Adatok beküldése
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    const data = {
      name: document.getElementById('name').value,
      people: document.getElementById('people').value,
      sleep: document.getElementById('sleep').value,
      sleepCount: document.getElementById('sleepCount').value,
      food: document.getElementById('food').value,
      special: document.getElementById('special').value
    };
    db.ref('participants').push(data);
    form.reset();
  });

  // Résztvevők listázása valós időben
  db.ref('participants').on('value', function(snapshot) {
    tableBody.innerHTML = '';
    snapshot.forEach(function(childSnapshot) {
      const child = childSnapshot.val();
      const tr = document.createElement('tr');
      tr.innerHTML = `<td>${child.name}</td>
                      <td>${child.people}</td>
                      <td>${child.sleep} (${child.sleepCount})</td>
                      <td>${child.food}</td>
                      <td>${child.special}</td>`;
      tableBody.appendChild(tr);
    });
  });

  // Összes adat törlése jelszóval
  deleteBtn.addEventListener('click', function() {
    if(deletePassword.value === PASSWORD){
      db.ref('participants').remove();
      deletePassword.value = '';
      alert('Sikeresen törölve!');
    } else {
      alert('Hibás jelszó!');
    }
  });
</script>

</body>
</html>
