<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Esküvői Regisztráció</title>
  <style>
    body {margin:0;font-family:Arial,sans-serif;background:linear-gradient(135deg,#000 30%,#f7c8c8 70%);color:#fff;}
    .container {max-width:900px;margin:0 auto;padding:20px;}
    header {text-align:center;margin-bottom:20px;}
    h1 {font-family:Georgia,serif;font-size:2.2em;color:#f7c8c8;}
    .tabs {display:flex;justify-content:center;margin-bottom:20px;flex-wrap:wrap;}
    .tab {padding:10px 20px;margin:5px;background:#222;color:#f7c8c8;border-radius:5px;cursor:pointer;}
    .tab.active {background:#c0c0c0;color:#000;}
    .tab-content {display:none;background:rgba(0,0,0,0.6);padding:20px;border-radius:10px;}
    .tab-content.active {display:block;}
    form {display:flex;flex-direction:column;gap:15px;}
    input[type=text],input[type=number],textarea {padding:10px;border-radius:5px;border:none;font-size:1em;}
    textarea {resize:vertical;}
    label {font-weight:bold;color:#f7c8c8;}
    button {padding:10px;border:none;border-radius:5px;background:#c0c0c0;color:#000;font-weight:bold;cursor:pointer;}
    button:hover {background:#f7c8c8;}
    table {width:100%;border-collapse:collapse;color:#fff;}
    th,td {border:1px solid #c0c0c0;padding:10px;text-align:left;}
    th {background:#222;}
    .delete-section input,#search {margin-bottom:10px;padding:8px;width:100%;border-radius:5px;border:none;}
    @media (max-width:600px){.tabs{flex-direction:column;align-items:center}th,td{font-size:.9em}}
  </style>
</head>
<body>
<div class="container">
  <header>
    <h1>Esküvői Regisztráció</h1>
  </header>

  <div class="tabs">
    <div class="tab active" data-target="registration">Regisztráció</div>
    <div class="tab" data-target="participants">Résztvevők</div>
  </div>

  <div class="tab-content active" id="registration">
    <form id="guestForm">
      <label>Név:</label>
      <input type="text" id="name" required placeholder="Például: Kovács Anna">

      <label>Hányan érkeznek:</label>
      <input type="number" id="people" required min="1" value="1">

      <label>Szeretne ott aludni? Ha igen, hányan:</label>
      <input type="number" id="sleep" min="0" value="0">

      <label>Ételérzékenység:</label>
      <input type="text" id="food" placeholder="pl. glutén, laktóz">

      <label>Speciális igények:</label>
      <textarea id="special" rows="2" placeholder="pl. vegetáriánus, szobatárs, transzport"></textarea>

      <button type="submit">Mentés</button>
    </form>
  </div>

  <div class="tab-content" id="participants">
    <div class="delete-section">
      <label>Jelszó az adatok törléséhez:</label>
      <input type="password" id="deletePass" placeholder="Írd be a törlési jelszót">
      <button id="deleteBtn">Összes adat törlése</button>
    </div>

    <input type="text" id="search" placeholder="Keresés név vagy kategória szerint">

    <table id="participantsTable">
      <thead>
        <tr>
          <th>Név</th>
          <th>Hányan jönnek</th>
          <th>Alvás</th>
          <th>Ételérzékenység</th>
          <th>Speciális igények</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
  import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC5A5bogaOqW6OKnUEzPxtFMadSiUj-2ZU",
    authDomain: "eskuvoiregisztracio.firebaseapp.com",
    databaseURL: "https://eskuvoiregisztracio-default-rtdb.firebaseio.com/",
    projectId: "eskuvoiregisztracio",
    storageBucket: "eskuvoiregisztracio.appspot.com",
    messagingSenderId: "113983296673",
    appId: "1:113983296673:web:b1f9a0c049bc42c6ab8ce0",
    measurementId: "G-2DJCG5N94C"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Tab váltás
  const tabs = document.querySelectorAll('.tab');
  const tabContents = document.querySelectorAll('.tab-content');
  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      const target = tab.dataset.target;
      tabContents.forEach(tc => {
        tc.classList.remove('active');
        if(tc.id === target) tc.classList.add('active');
      });
    });
  });

  const form = document.getElementById('guestForm');
  const tableBody = document.querySelector('#participantsTable tbody');
  const participantsRef = ref(db, 'participants');

  // Új adat mentése
  form.addEventListener('submit', e => {
    e.preventDefault();
    const guest = {
      name: document.getElementById('name').value.trim(),
      people: document.getElementById('people').value,
      sleep: document.getElementById('sleep').value,
      food: document.getElementById('food').value.trim(),
      special: document.getElementById('special').value.trim()
    };
    push(participantsRef, guest);
    form.reset();
  });

  // Táblázat frissítése
  onValue(participantsRef, snapshot => {
    tableBody.innerHTML = '';
    snapshot.forEach(child => {
      const p = child.val();
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${p.name}</td>
        <td>${p.people}</td>
        <td>${p.sleep}</td>
        <td>${p.food}</td>
        <td>${p.special}</td>
      `;
      tableBody.appendChild(row);
    });
  });

  // Keresés
  document.getElementById('search').addEventListener('input', e => {
    const term = e.target.value.toLowerCase();
    const rows = tableBody.querySelectorAll('tr');
    rows.forEach(row => {
      row.style.display = [...row.cells].some(cell => cell.textContent.toLowerCase().includes(term)) ? '' : 'none';
    });
  });

  // Adatok törlése jelszóval
  document.getElementById('deleteBtn').addEventListener('click', () => {
    const pass = document.getElementById('deletePass').value;
    if(pass === 'csigakaki'){
      if(confirm('Biztosan törlöd az összes adatot?')){
        remove(participantsRef);
        document.getElementById('deletePass').value = '';
      }
    } else {
      alert('Helytelen jelszó!');
    }
  });
</script>
</body>
</html>
